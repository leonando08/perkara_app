<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagnosa Link Register</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        body { padding: 20px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .success { background-color: #d4edda; }
        .error { background-color: #f8d7da; }
        .info { background-color: #d1ecf1; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Diagnosa Link Register</h1>
        <p>Halaman ini untuk mengetes apakah link ke register bekerja.</p>
        
        <div class="test-section info">
            <h3><i class="bi bi-info-circle"></i> Informasi</h3>
            <p><strong>Target URL:</strong> <code>http://localhost:8080/index.php/auth_simple/register</code></p>
            <p><strong>Current URL:</strong> <code id="current-url"></code></p>
            <p><strong>Browser:</strong> <code id="browser-info"></code></p>
        </div>

        <div class="test-section">
            <h3>Test 1: Link HTML Biasa</h3>
            <a href="http://localhost:8080/index.php/auth_simple/register" 
               class="btn btn-primary">
                Klik Link Ini
            </a>
        </div>

        <div class="test-section">
            <h3>Test 2: Link dengan Relative Path</h3>
            <a href="/index.php/auth_simple/register" 
               class="btn btn-success">
                Klik Link Ini
            </a>
        </div>

        <div class="test-section">
            <h3>Test 3: Button dengan window.location</h3>
            <button class="btn btn-info" onclick="window.location.href='http://localhost:8080/index.php/auth_simple/register'">
                Klik Button Ini
            </button>
        </div>

        <div class="test-section">
            <h3>Test 4: Button dengan window.location (relative)</h3>
            <button class="btn btn-warning" onclick="window.location.href='/index.php/auth_simple/register'">
                Klik Button Ini
            </button>
        </div>

        <div class="test-section">
            <h3>Test 5: Link dengan target="_blank"</h3>
            <a href="http://localhost:8080/index.php/auth_simple/register" 
               target="_blank"
               class="btn btn-secondary">
                Buka di Tab Baru
            </a>
        </div>

        <div class="test-section">
            <h3>Test 6: Form GET Submit</h3>
            <form method="GET" action="/index.php/auth_simple/register">
                <button type="submit" class="btn btn-danger">
                    Submit Form
                </button>
            </form>
        </div>

        <div class="test-section">
            <h3>Test 7: Link dengan Event Listener</h3>
            <button id="test-7-btn" class="btn btn-dark">
                Klik Button Ini (Event Listener)
            </button>
        </div>

        <div class="test-section info">
            <h3><i class="bi bi-clipboard-check"></i> Instruksi</h3>
            <ol>
                <li>Coba klik setiap test di atas satu per satu</li>
                <li>Catat test mana yang <strong>berhasil</strong> membuka halaman register</li>
                <li>Catat test mana yang <strong>gagal</strong></li>
                <li>Buka Console (F12) dan lihat apakah ada error</li>
                <li>Screenshot hasil test dan console log jika ada masalah</li>
            </ol>
        </div>

        <div class="test-section">
            <h3><i class="bi bi-terminal"></i> Console Log</h3>
            <div id="log-output" style="background: #f8f9fa; padding: 15px; border-radius: 5px; font-family: monospace; min-height: 100px;"></div>
        </div>

        <hr>
        
        <div class="test-section">
            <h3><i class="bi bi-house-door"></i> Kembali</h3>
            <a href="http://localhost:8080" class="btn btn-outline-primary">
                <i class="bi bi-arrow-left"></i> Kembali ke Login
            </a>
        </div>
    </div>

    <script>
        // Display current URL and browser info
        document.getElementById('current-url').textContent = window.location.href;
        document.getElementById('browser-info').textContent = navigator.userAgent;

        // Custom logger
        const logOutput = document.getElementById('log-output');
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? 'red' : type === 'success' ? 'green' : 'blue';
            logOutput.innerHTML += `<div style="color: ${color};">[${timestamp}] ${message}</div>`;
            console.log(message);
        }

        // Test 7: Event listener
        document.getElementById('test-7-btn').addEventListener('click', function() {
            log('Test 7: Button clicked with event listener', 'info');
            try {
                window.location.href = '/index.php/auth_simple/register';
                log('Test 7: Navigation initiated', 'success');
            } catch (e) {
                log('Test 7: Error - ' + e.message, 'error');
            }
        });

        // Log all link clicks
        document.querySelectorAll('a, button').forEach(element => {
            element.addEventListener('click', function(e) {
                const target = this.textContent.trim();
                const href = this.getAttribute('href') || this.getAttribute('onclick');
                log(`Clicked: "${target.substring(0, 30)}" - Target: ${href}`, 'info');
            });
        });

        // Check if register controller is accessible
        log('Checking if register endpoint is accessible...', 'info');
        fetch('/index.php/auth_simple/register', { method: 'HEAD' })
            .then(response => {
                if (response.ok) {
                    log('✅ Register endpoint is accessible (Status: ' + response.status + ')', 'success');
                } else {
                    log('❌ Register endpoint returned status: ' + response.status, 'error');
                }
            })
            .catch(error => {
                log('❌ Failed to check register endpoint: ' + error.message, 'error');
            });

        log('Halaman loaded successfully', 'success');
    </script>
</body>
</html>
